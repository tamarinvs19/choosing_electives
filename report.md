# Веб-интерфейс для выбора элективов

Участники проекта: Вячеслав Тамарин

Руководитель: Виталий Брагилевский

Репозиторий: [https://github.com/tamarinvs19/choosing_electives/](https://github.com/tamarinvs19/choosing_electives/)

## Описание

Основная задача проекта - организовать удобный интерфейс по выбору спецкурсов на 3-4 семестр для студентов МКН, а также сервис для получения информации о статистике для администрации.

### В чем отличия от текущей системы?

1. Главное отличие - студенты смогут видеть статистику поданных заявлений на каждый курс (и каждую его вариацию языков и форматов). За счет этого уже в процессе выбора будут видны курсы, которые состоятся с высокой вероятностью, и курсы, которые скорее всего не состоятся. Это даст возможность лучше управлять набором элективов на следующие семестры, в том числе за счет того, что наборы курсов в заявлении должны стать меньше.
2. Второе отличие - "почти" одновременный выбор курсов на осень и весну: первый поток заявлений формируется на оба семестра, а после того, как курсы на осень определены, можно откорректировать весну. Это позволяет правильно обрабатывать заявления на электив, предсталенный на оба семестра, а именно, выбирать тот, на который подалось больше. 
3. Дополнительный ожидаемый эффект от первых двух пунктов - так как всем видно количество заявлений на осень и на весну, поэтому студенты смогут либо просто выбрать более популярный семестр, либо убедить остальных взять другой. 
4. Статистика для администрации - можно в процессе выбора, например, делать объявления о том, что какой-то курс скорее всего пройдет / пройдет в конкретном семестре / не пройдет.
5. Встроенный интерфейс для упорядочивания элективов и подсчета зачетных единиц. Хочется минимизировать потребность студентов использовать внешние ресурсы для составления заявлений, что упростит процесс и уменьшит возможное число ошибок.

На данный момент предполагается использование данного проекта в качестве обертки над системой, действующей сейчас. Данные о курсах загружаются с [сайта А.С.Охотина](https://users.math-cs.spbu.ru/~okhotin/course_process/course_announcement_autumn2021.html) и используются на сайте. При промежуточной и конечной подаче будет генерироваться строка из кодов элективов.

### Технологии

Серверная часть разрабатывается на Python с использованием фреймворка [Django](https://www.djangoproject.com), для парсинга страницы элективов используется BeautifulSoup. Основное содержание веб-страниц создается через Django-шаблоны на сервере.

Для представления страниц в браузере применяются инструменты фреймворка [Bootstrap](https://getbootstrap.com). Запросы к серверу и логика на стороне клиента реализуются с помощью библиотеки [jQuery](https://jquery.com). Также для сортировки курсов на странице студента взята библиотека [SortableJS](https://github.com/SortableJS/Sortable).

## Текущее состояние проекта

На данный момент реализованы модели для хранения данных, парсинг страницы с курсами и их сохранение в базу данных.
<br>
Курсы могут быть либо большими, либо малыми, либо семинарами; у первых двух есть возможность взять без экзамена (и на одну з.е. меньше). Каждый тип может быть весенним и осенним. Можно создавать модели групп студентов (по году обучения и направлению) и для каждой такой группы добавлять следующие ограничения : максимальные и минимальные количества количества зачетных единиц на осень и весну, максимальное и минимальное количество экзаменов, максимальное число облегченных курсов, максимальное количество курсов по программированию. Также можно определить курс обязательным для какой-то группы студентов.

На главной странице размещается список сгруппированных по тематикам курсов, которые по умолчанию свернуты, за счет чего не нужно искать по длинному списоку интересующую группу.
У каждого курса отображается текущее количество заявлений для каждого типа, можно создать или удалить свое заявление.

Каждый курс имеет собственную страничку, где отображаются ссылки на описание, список студентов, возможные типы проведения. Аналогично можно создать или удалить свое заявление на каждый из типов.

На индивидуальной для пользователей странице сортировки заявлений на данный момент можно просматривать все заявления, редактировать наличие экзамена. Пока что только в интерфейсе их можно сортировать и разделять на осень и весну.


## Трудности

* Первая проблема в самом начале разработки - как правильно структурировать модели. Несколько раз приходилось менять схемы, добавлять новые поля и связи. Например, изначально обязательный курс привязывался к студенту, а не к группе, но тогда бы эту связь пришлось бы добавлять к каждому новому студенту из группы, хотя они все одинаковые. Также в процессе парсинга таблицы ограничений были наложены новые ограничения, некоторые убраны. Изначально использовалась модель преподавателя курса, но скорее всего она уже не понадобится и ее тоже нужно будет удалить. Часто после сильных изменений базу данных приходилось удалять, что могло бы быть еще большей проблемой, если там были бы реальные данные. 
* Еще одной проблемой является медленное получение данных для главной страницы списка курсов. Пока у меня не получилось решить, сейчас на сбор данных для списка элективов занимает где-то полсекунды, происходит достаточно много отдельных запросов к базе данных, затем обработка и группировка в формат для использования в шаблоне. Скорее всего нужно будет вручную написать запрос к базе данных, который сможет сгрупировать и посчитать все (или хотя бы почти все), что сейчас делает Python.
* При разработке интерфейса страницы сортировки курсов пространства не хватало для размещения запланированного (должны были быть две колонки для осенних и весенних курсов и еще пространство для группировки курсов), но на данный момент пришлось отказаться от этого и оставить две колонки для семестров и две колонки для нераспределенных курсов. Была идея сделать семестровые колонки сворачивающимися, но это только помешало бы на экранах смартфонов (весь экран был бы закрыт колонкой, поэтому ничего туда не перетащить). Возможно, имеет смысл не ограничиваться одним экраном и добавить возможность добавлять свои колонки с горизонтальной прокруткой экрана.

## Дальшейшие планы

1. Доделать на сервере разделение по осенним и весенним заявлениям и сохранение порядковых приоритетов.
2. Добавить функциональнось на странице сортировки: удаление заявления, добавление другого типа курса, подсчет зачетных единиц.
3. Подключить регистрацию пользователей через Slack.
4. Реализовать генерацию конечной строки-заявления.
5. Интрефейс для администрации: возможность получения сводных таблиц и статистики.
6. Обработка обязательных курсов: автоматическое добавление после парсинга, отображение на странице сортировки и скрытие на общей странице.
7. Развернуть проект на внешнем хостинге.
8. Собрать и проанализировать отзывы студентов, когда будет готова предварительная версия.
9. Создать английскую версию интерфейса.

### Об огранизации
Периодически созваниваемся и обсуждаем, что сделано, что буду делать далее. Хочется делать это чаще, но проблема в том, что у меня не хватает времени и на учебу, и на проект, и на обсуждение.
