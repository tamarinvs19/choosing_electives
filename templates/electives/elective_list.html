{% extends "base.html" %}
{% block head_title %}
  Elective list
{% endblock %}
{% block body %}
  <div class="switch-container">
    Open all
    <label class="switch">
      <input type="checkbox" onchange="clickSwitch(this)">
      <span class="slider round"></span>
    </label>
  </div>
  <div class="accordion accordion-flush" id="accordionPanelsElective">
  {% for thematic, electives in elective_groups.items %}
    {% include "electives/themetic_list.html" with thematic=thematic electives=electives student_id=student_id %}
  {% endfor %}
  </div>
  <script>
  function getCookie(name) {
          let cookieValue = null;
          if (document.cookie && document.cookie !== '') {
              const cookies = document.cookie.split(';');
              for (let i = 0; i < cookies.length; i++) {
                  const cookie = cookies[i].trim();
                  // Does this cookie string begin with the name we want?
                  if (cookie.substring(0, name.length + 1) === (name + '=')) {
                      cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                      break;
                  }
              }
          }
          return cookieValue;
      }
      const csrftoken = getCookie('csrftoken');

      function change_kind(electiveId, kindId) {
          $.post("{% url 'electives:change_kind' %}",
              {'kind_id': kindId, 'elective_id': electiveId, 'csrfmiddlewaretoken': csrftoken},
              function(data) {
                  $(`#statistic-${electiveId}-${kindId}`)[0].innerHTML = data['students_count'][true];
                  $(`#statistic-maybe-${electiveId}-${kindId}`)[0].innerHTML = data['students_count'][false];
                  if (data['move'] !== null && data['other_language_kind'] !== null) {
                      $(`#statistic-${electiveId}-${data['other_language_kind']}`)[0].innerHTML = data['other_kind_counts'][true];
                      $(`#statistic-maybe-${electiveId}-${data['other_language_kind']}`)[0].innerHTML = data['other_kind_counts'][false];
                      $(`#button-${data['other_short_name']}-${electiveId}`)[0].checked = false;
                  }
              });
      }

      function clickSwitch(input) {
          if (input.checked) {
              $('.accordion-collapse').addClass('show');
          } else {
              $('.accordion-collapse').removeClass('show');
          }
      }

  </script>
{% endblock %}
